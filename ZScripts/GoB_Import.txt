[VarDef,GoBImport,0]
[VarSet,noteTimer,1]

[If,GoBImport==0,

    // create variables
    [VarDef,subtoolMissing, -1]     // replace with subtool index if subtool already exists
    [VarDef,fileExtension,".obj"]
    [VarDef,objectName,"EQ"]   //object name to import
    [VarDef,defaultPath,"C:\Users\Public\Pixologic\GoZProjects\Default\"]
    [VarDef,objectPath,[StrMerge,defaultPath,objectName,fileExtension]]        

    [VarDef,diffTexture,[StrMerge,defaultPath,"EQ_diff.bmp"]]
    [VarDef,normTexture,[StrMerge,defaultPath,"EQ_norm.bmp"]]
    [VarDef,dispTexture,[StrMerge,defaultPath,"EQ_disp.bmp"]]



    /* [VarDef,gobSettings,[StrMerge,defaultPath,"GoBSetting.zvr"]
    [VarSave,objectName,gobSettings]
    [VarSave,diffTexture,gobSettings]
    [VarSave,normTexture,gobSettings]
    [VarSave,dispTexture,gobSettings]

    [VarLoad,objectName,gobSettings]
    [VarLoad,diffTexture,gobSettings]
    [VarLoad,normTexture,gobSettings]
    [VarLoad,dispTexture,gobSettings] */



    [VarDef,subtoolName,""]     // Define a new variable to store the current subtool name 
    [VarDef,subtool(1024),0]    // Define a Variable list to store the subtool active index
    [VarSet,totalSubtools,[SubToolGetCount]]    // create a variable to define the number of loop based on the subtools count
    
    [SubToolSelect,0]   // select first subtool
    [VarSet,activeSubtool,[SubToolGetActiveIndex]]  // create a variable with the current subtool Index
    
    [Loop,totalSubtools, //loop over subtools
        [SubToolSelect,[Val,activeSubtool]]
        [VarSet,subtoolName,[IGetTitle,"Tool:ItemInfo"]]   //get the subtool name
        [VarSet,subtoolName,[StrExtract,subtoolName,0,[StrLength,subtoolName]-2]]   // trim chars from the end.
        [If,subtoolMissing == -1,
            [If,([StrFind,subtoolName,objectName]==0) && ([StrLength,subtoolName]==[StrLength,objectName]),   // subtool not found,create a new one                 
                [VarSet,subtoolMissing, activeSubtool]   
                //[Note,[StrMerge,"subtool found: ",subtoolName, ", index: ",  subtoolMissing],,noteTimer]
            ]
        ]        
        //[Note, [StrMerge,activeSubtool, " activeSubtool: ",subtoolName],,noteTimer]   //displays message for 1 second
        [VarSet,activeSubtool,(activeSubtool+1)]    //adds 1 to the value of counter variable
    ] //end of Loop

    [If,subtoolMissing == -1,    
        // subtool exists,update subtool 
        [IPress,Tool:SubTool:Append]
        [IPress,PopUp:PolyMesh3D]
        [IPress,Tool:SubTool:PolyMesh3D1]

        [If,[FileExists,objectPath],
            [FileNameSetNext,objectPath]
            [IPress,Tool:Import]
        ]  
        [Note,[StrMerge,"subtoolMissing: ",subtoolMissing],,10]
        
    ,        
        [SubToolSelect,[Val,subtoolMissing]]
        [If,[FileExists,objectPath],
            [FileNameSetNext,objectPath]
            [IPress,Tool:Import]
        ]
        [Note,[StrMerge,"subtoolMissing: ",subtoolMissing],,noteTimer]
    ]
    

    // import textures
    [IPress,Tool:Texture Map:TextureMap]
    [FileNameSetNext,[StrMerge,defaultPath,"EQ_diff.bmp"]] [IPress,Texture:Import]
    [IPress,Tool:Displacement Map:DisplacementMap]
    [FileNameSetNext,[StrMerge,defaultPath,"EQ_disp.bmp"]] [IPress,Alpha:Import]
    [IPress,Tool:Normal Map:Normal Map]
    [FileNameSetNext,[StrMerge,defaultPath,"EQ_norm.bmp"]] [IPress,Texture:Import]

      
    
]/*End of ZScript*/
